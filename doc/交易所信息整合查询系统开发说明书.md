# 交易所信息整合查询系统 开发说明书

## 目录

1. 项目结构与技术栈
2. 环境准备
3. 数据结构与采集规范
4. 后端开发流程
5. 前端开发流程
6. 测试说明
7. 部署与运维
8. 其他说明

---

## 1. 项目结构与技术栈

- 后端：Node.js + Express
- 前端：React/Vue/原生JS
- 数据存储：本地JSON文件
- 定时任务：node-cron
- 配置文件：.env、config（由用户维护）
- 依赖最小化，UI尽量原生

目录建议：

```
/exchange-info-query/
  /backend/
    |- data/               # 存放JSON数据
    |- config/             # 配置文件
    |- scripts/            # 数据采集脚本
    |- app.js              # 主服务入口
    |- package.json
  /frontend/
    |- src/
    |- public/
    |- package.json
  .env
  README.md
```

---

## 2. 环境准备

- Node.js 18+ 环境
- 配置好.env和config文件（含各交易所API、支持币种、链等信息）
- 安装依赖（后端、前端各自npm install）

---

## 3. 数据结构与采集规范

- 采集各交易所API，兼容不同数据结构，合并为统一JSON格式
- JSON文件结构详见设计文档（含last_update、tokens、exchanges、chains等字段）
- 支持多链、合约地址、充提状态等
- 采集脚本需兼容字段差异，出错时保留上次数据并记录日志

---

## 4. 后端开发流程

### 4.1 数据采集与定时刷新

- 使用node-cron定时执行采集脚本
- 采集各交易所API数据，按config和part3文档适配字段
- 合并并写入本地JSON文件
- 记录last_update时间

### 4.2 API接口开发

- `/api/tokens`：返回所有支持代币列表
- `/api/status?symbol=xxx`：返回指定代币的所有交易所充提状态和合约信息
- `/api/last_update`：返回数据最后更新时间
- 预留鉴权接口（如需启用）

### 4.3 错误处理与日志

- 采集失败时保留上次数据
- 记录详细错误日志

---

## 5. 前端开发流程

### 5.1 页面结构

- 显示“上次更新时间”
- 下拉选择代币
- 查询按钮
- 表格展示（交易所、链、充提状态、合约地址）

### 5.2 数据对接

- 调用后端API获取数据
- 渲染下拉、表格、更新时间

### 5.3 交互与样式

- 保持简洁、响应式设计
- 深色系UI

---

## 6. 测试说明

- 后端API接口测试（含异常情况）
- 前端主要功能手动测试
- 如有条件可补充单元测试

---

## 7. 部署与运维

- 后端建议用PM2或Supervisor守护进程
- 前端静态部署（nginx、Vercel等）
- 定期备份JSON数据
- 监控运行日志和错误

---

## 8. 其他说明

- 配置和API接口如有调整，需同步更新采集脚本和前端适配
- 如需多语言、权限等扩展，后续可按需开发

---

**[开发进度标注区]**

- [ ] 4.1 数据采集与定时刷新（已完成：已实现定时采集各交易所API并合并JSON数据，支持多链、合约地址、充提状态等，出错时保留上次数据并记录日志）
- [ ] 4.2 API接口开发（已完成：实现了 /api/tokens、/api/status、/api/last_update 三个接口，支持按symbol查询、返回标准化数据，并预留鉴权扩展）
- [ ] 4.3 错误处理与日志
- [ ] 5.1 页面结构
- [ ] 5.2 数据对接
- [ ] 5.3 交互与样式
- [ ] 6. 测试说明
- [ ] 7. 部署与运维

每一部分开发完成后，会在此处打钩并注明完成情况。
